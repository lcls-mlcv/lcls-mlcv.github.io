---
layout: projects
title: X-RAI
description: Scalable 3D Reconstruction for X-Ray Single Particle Imaging Based on Online Machine Learning
img: assets/img/publication_preview/shenoy2023scalable.jpg
importance: 1
category: AtomicSPI
related_publications: true
---
X-ray free-electron lasers (XFELs) offer unique capabilities for measuring the structure and dynamics of biomolecules, helping us understand the basic building blocks of life. Notably, high-repetition-rate XFELs enable single particle imaging (X-ray SPI) where individual, weakly scattering biomolecules are imaged under near-physiological conditions with the opportunity to access fleeting states that cannot be captured in cryogenic or crystallized conditions. Existing X-ray SPI reconstruction algorithms, which estimate the unknown orientation of a particle in each captured image as well as its shared 3D structure, are inadequate in handling the massive datasets generated by these emerging XFELs.

{% include figure.liquid path="assets/img/publication_preview/shenoy2023scalable.jpg" title="X-RAI" caption="Illustration of XFEL SPI image acquisition process and subsequent online processing by our algorithm. A femtosecond-resolution X-ray pulse intersects a single, hydrated
molecule, creating a diffraction image. This process is repeated at high rates to collect millions of diffraction images, each observing the molecule with an unknown orientation, or pose.
Our algorithm, X-RAI, employs a CNN-based encoder fψ to efficiently estimate the pose Rφ
of the molecule in each image. A physically accurate decoder Γ (in Fourier space, shown here
in real space) produces a noise-free estimate of the diffraction pattern using the molecule’s 3D
structure, represented as a neural field Vθ. The symmetric loss Lsym is applied to optimize the
parameters ψ and θ in an online fashion using self-supervision. At any point during the experiment, the volume Vθ can be phased to obtain an estimate of the electron density."%}

Here, we introduce X-RAI, an online reconstruction framework that estimates the structure of a 3D macromolecule from large X-ray SPI datasets {%cite shenoy2023amortized shenoy2023scalable %}. X-RAI consists of a convolutional encoder, which amortizes pose estimation over large datasets, as well as a physics-based decoder, which employs an implicit neural representation to enable high-quality 3D reconstruction in an end-to-end, self-supervised manner.

{% include figure.liquid path="assets/img/projects/xrai.jpg" title="X-RAI" caption="Reconstruction of a cubic gold nanoparticle from experimental data collected at an
XFEL facility. To enforce the known cubic symmetry of the nanoparticle, we augment
the encoder’s orientation estimates with the symmetry rotations of the cube (equivalent to the
octahedral symmetry group), effectively spreading out the pose estimates over SO(3). The re-
sulting density reconstruction is of resolution 5.74 nanometers. Only the low-resolution panels
of the diffraction content are used for reconstruction and shown in this figure as they contain
the majority of the diffraction signal. The patterns are displayed with reduced image contrast.
16"%}

We demonstrate that X-RAI achieves state-of-the-art performance for small-scale datasets in simulation and challenging experimental settings and demonstrate its unprecedented ability to process large datasets containing millions of diffraction images in an online fashion. These abilities signify a paradigm shift in X-ray SPI towards real-time capture and reconstruction.
